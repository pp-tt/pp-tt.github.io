<!DOCTYPE html>
<html dir="ltr" lang="zh">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="TensorFlow ç¬”è®°ï¼ˆäºŒï¼‰ # ä»‹ç»ç¥ç»ç½‘ç»œçš„ä¼˜åŒ–è¿‡ç¨‹ï¼Œä¸»è¦æœ‰ï¼š
ç¥ç»ç½‘ç»œå¤æ‚åº¦ æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡ æ¿€æ´»å‡½æ•° æŸå¤±å‡½æ•° æ¬ æ‹Ÿåˆä¸è¿‡æ‹Ÿåˆ æ­£åˆ™åŒ–å‡å°‘è¿‡æ‹Ÿåˆ ä¼˜åŒ–å™¨æ›´æ–°ç½‘ç»œå‚æ•° 1. é¢„å¤‡çŸ¥è¯† # tf.where(æ¡ä»¶è¯­å¥ï¼ŒçœŸè¿”å›Aï¼Œå‡è¿”å›B)ï¼šæ¡ä»¶è¯­å¥ï¼ŒçœŸè¿”å›Aï¼Œå‡è¿”å›B a = tf.constant([1, 2, 3, 1, 1]) b = tf.constant([0, 1, 3, 4, 5]) c = tf.where(tf.greater(a, b), a, b) # è‹¥a&gt;bï¼Œè¿”å› a å¯¹åº”ä½ç½®çš„å…ƒç´ ï¼Œå¦åˆ™è¿”å› b å¯¹åº”ä½ç½®çš„å…ƒç´  è¾“å‡ºï¼šc = tf.Tensor([1 2 3 4 5], shape=(5,), dtype=int32) np.random.RandomState.rand(ç»´åº¦)ï¼šè¿”å› [0, 1) ä¹‹é—´çš„éšæœºæ•° rdm = np.random.RandomState(seed=1) a = rdm.rand() # è¿”å›ä¸€ä¸ªéšæœºæ ‡é‡ b = rdm.rand(2, 3) # è¿”å›ç»´åº¦ä¸º2è¡Œ3åˆ—éšæœºæ•°çŸ©é˜µ np.vstack(æ•°ç»„1ï¼Œ æ•°ç»„2)ï¼šå°†ä¸¤ä¸ªæ•°ç»„æŒ‰å‚ç›´æ–¹å‘å åŠ  a = np." name="description"/>
<meta content="#FFFFFF" name="theme-color"/>
<meta content="light dark" name="color-scheme"/><meta content="" property="og:title"/>
<meta content="TensorFlow ç¬”è®°ï¼ˆäºŒï¼‰ # ä»‹ç»ç¥ç»ç½‘ç»œçš„ä¼˜åŒ–è¿‡ç¨‹ï¼Œä¸»è¦æœ‰ï¼š
ç¥ç»ç½‘ç»œå¤æ‚åº¦ æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡ æ¿€æ´»å‡½æ•° æŸå¤±å‡½æ•° æ¬ æ‹Ÿåˆä¸è¿‡æ‹Ÿåˆ æ­£åˆ™åŒ–å‡å°‘è¿‡æ‹Ÿåˆ ä¼˜åŒ–å™¨æ›´æ–°ç½‘ç»œå‚æ•° 1. é¢„å¤‡çŸ¥è¯† # tf.where(æ¡ä»¶è¯­å¥ï¼ŒçœŸè¿”å›Aï¼Œå‡è¿”å›B)ï¼šæ¡ä»¶è¯­å¥ï¼ŒçœŸè¿”å›Aï¼Œå‡è¿”å›B a = tf.constant([1, 2, 3, 1, 1]) b = tf.constant([0, 1, 3, 4, 5]) c = tf.where(tf.greater(a, b), a, b) # è‹¥a&gt;bï¼Œè¿”å› a å¯¹åº”ä½ç½®çš„å…ƒç´ ï¼Œå¦åˆ™è¿”å› b å¯¹åº”ä½ç½®çš„å…ƒç´  è¾“å‡ºï¼šc = tf.Tensor([1 2 3 4 5], shape=(5,), dtype=int32) np.random.RandomState.rand(ç»´åº¦)ï¼šè¿”å› [0, 1) ä¹‹é—´çš„éšæœºæ•° rdm = np.random.RandomState(seed=1) a = rdm.rand() # è¿”å›ä¸€ä¸ªéšæœºæ ‡é‡ b = rdm.rand(2, 3) # è¿”å›ç»´åº¦ä¸º2è¡Œ3åˆ—éšæœºæ•°çŸ©é˜µ np.vstack(æ•°ç»„1ï¼Œ æ•°ç»„2)ï¼šå°†ä¸¤ä¸ªæ•°ç»„æŒ‰å‚ç›´æ–¹å‘å åŠ  a = np." property="og:description"/>
<meta content="article" property="og:type"/>
<meta content="https://pp-tt.github.io.git/notes/tensorflow/tensorflow-%E7%AC%94%E8%AE%B0%E4%BA%8C/" property="og:url"/><meta content="notes" property="article:section"/>
<title>Tensor Flow ç¬”è®°ï¼ˆäºŒï¼‰ | å™—é€š ğŸ€</title>
<link href="/manifest.json" rel="manifest"/>
<link href="/favicon.png" rel="icon" type="image/x-icon"/>
<link crossorigin="anonymous" href="/book.min.a82d7e77ceb134d151c4d7e381eeb30623fbd5a524d58c584d8716ecec0205bd.css" integrity="sha256-qC1+d86xNNFRxNfjge6zBiP71aUk1YxYTYcW7OwCBb0=" rel="stylesheet"/>
<script defer="" src="/flexsearch.min.js"></script>
<script crossorigin="anonymous" defer="" integrity="sha256-bvvSeOt+kqT2EcxvtEJLycY1J7HRvYurUKXXFWQ1vWU=" src="/zh.search.min.6efbd278eb7e92a4f611cc6fb4424bc9c63527b1d1bd8bab50a5d7156435bd65.js"></script>
<script crossorigin="anonymous" defer="" integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
</head>
<body dir="ltr">
<input class="hidden toggle" id="menu-control" type="checkbox"/>
<input class="hidden toggle" id="toc-control" type="checkbox"/>
<main class="container flex">
<aside class="book-menu">
<div class="book-menu-content">
<nav>
<h2 class="book-brand">
<a class="flex align-center" href="/"><span>å™—é€š ğŸ€</span>
</a>
</h2>
<div class="book-search">
<input aria-label="Search" data-hotkeys="s/" id="book-search-input" maxlength="64" placeholder="Search" type="text"/>
<div class="book-search-spinner hidden"></div>
<ul id="book-search-results"></ul>
</div>
<ul>
<li class="book-section-flat">
<span>--å­¦ä¹ ç¬”è®°--ğŸ‘‡</span>
<ul>
<li>
<input class="toggle" id="section-0f70934a6e5284fbc93928c61dfe9c83" type="checkbox"/>
<label class="flex justify-between" for="section-0f70934a6e5284fbc93928c61dfe9c83">
<a class="" role="button">Java</a>
</label>
<ul>
<li>
<a class="" href="/notes/java/arraylist-%E6%89%A9%E5%AE%B9%E8%A7%84%E5%88%99/">Array List æ‰©å®¹è§„åˆ™</a>
</li>
<li>
<a class="" href="/notes/java/hashmap-%E7%9B%B8%E5%85%B3%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/">Hash Map ç›¸å…³å­¦ä¹ æ€»ç»“</a>
</li>
<li>
<a class="" href="/notes/java/java-%E5%8F%8D%E5%B0%84/">Java åå°„</a>
</li>
</ul>
</li>
<li>
<input class="toggle" id="section-4364152b7ab5995d509c0b7b811005c4" type="checkbox"/>
<label class="flex justify-between" for="section-4364152b7ab5995d509c0b7b811005c4">
<a class="" role="button">JVM</a>
</label>
<ul>
<li>
<a class="" href="/notes/jvm/%E4%BB%80%E4%B9%88%E6%98%AF-jvm/">ä»€ä¹ˆæ˜¯ Jvm</a>
</li>
<li>
<a class="" href="/notes/jvm/%E7%A8%8B%E5%BA%8F%E8%AE%A1%E6%95%B0%E5%99%A8/">ç¨‹åºè®¡æ•°å™¨</a>
</li>
<li>
<a class="" href="/notes/jvm/%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%A0%88/">è™šæ‹Ÿæœºæ ˆ</a>
</li>
<li>
<a class="" href="/notes/jvm/%E6%9C%AC%E5%9C%B0%E6%96%B9%E6%B3%95%E6%A0%88-/">æœ¬åœ°æ–¹æ³•æ ˆ</a>
</li>
<li>
<a class="" href="/notes/jvm/%E5%A0%86/">å †</a>
</li>
<li>
<a class="" href="/notes/jvm/%E6%96%B9%E6%B3%95%E5%8C%BA/">æ–¹æ³•åŒº</a>
</li>
<li>
<a class="" href="/notes/jvm/%E7%9B%B4%E6%8E%A5%E5%86%85%E5%AD%98/">ç›´æ¥å†…å­˜</a>
</li>
<li>
<a class="" href="/notes/jvm/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/">åƒåœ¾å›æ”¶</a>
</li>
<li>
<a class="" href="/notes/jvm/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8/">åƒåœ¾å›æ”¶å™¨</a>
</li>
</ul>
</li>
<li>
<input class="toggle" id="section-b7444509cb631180897a34f028407c2c" type="checkbox"/>
<label class="flex justify-between" for="section-b7444509cb631180897a34f028407c2c">
<a class="" role="button">è®¾è®¡æ¨¡å¼</a>
</label>
<ul>
<li>
<a class="" href="/notes/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/uml-%E5%9B%BE%E9%BB%91%E9%A9%AC/">Uml å›¾ï¼ˆé»‘é©¬ï¼‰</a>
</li>
<li>
<a class="" href="/notes/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99%E9%BB%91%E9%A9%AC/">è®¾è®¡åŸåˆ™ï¼ˆé»‘é©¬ï¼‰</a>
</li>
<li>
<a class="" href="/notes/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F%E9%BB%91%E9%A9%AC/">åˆ›å»ºå‹æ¨¡å¼ï¼ˆé»‘é©¬ï¼‰</a>
</li>
<li>
<a class="" href="/notes/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F%E9%BB%91%E9%A9%AC/">ç»“æ„å‹æ¨¡å¼ï¼ˆé»‘é©¬ï¼‰</a>
</li>
<li>
<a class="" href="/notes/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F%E9%BB%91%E9%A9%AC/">è¡Œä¸ºå‹æ¨¡å¼ï¼ˆé»‘é©¬ï¼‰</a>
</li>
</ul>
</li>
<li>
<input class="toggle" id="section-61661238f18c0095524962a5d1d6e676" type="checkbox"/>
<label class="flex justify-between" for="section-61661238f18c0095524962a5d1d6e676">
<a class="" role="button">Spring</a>
</label>
<ul>
<li>
<a class="" href="/notes/spring/beanfactory%E4%B8%8Eapplicationcontext/">Bean Factoryä¸ Application Context</a>
</li>
<li>
<a class="" href="/notes/spring/nacos-%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83/">Nacos é…ç½®ä¸­å¿ƒ</a>
</li>
<li>
<a class="" href="/notes/spring/open-feign-%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8%E7%A4%BA%E4%BE%8B/">Open Feign è¿œç¨‹è°ƒç”¨ç¤ºä¾‹</a>
</li>
<li>
<a class="" href="/notes/spring/springboot-%E6%95%B4%E5%90%88-mybatis-plus/">Spring Boot æ•´åˆ My Batis Plus</a>
</li>
</ul>
</li>
<li>
<input class="toggle" id="section-58f730a0b22fcdc7a886db614d77f88c" type="checkbox"/>
<label class="flex justify-between" for="section-58f730a0b22fcdc7a886db614d77f88c">
<a class="" role="button">ä»£ç éšæƒ³å½•åˆ·é¢˜</a>
</label>
<ul>
<li>
<a class="" href="/notes/leetcode/day001-%E7%AC%AC%E4%B8%80%E7%AB%A0%E6%95%B0%E7%BB%84/">Day001 ç¬¬ä¸€ç« æ•°ç»„</a>
</li>
<li>
<a class="" href="/notes/leetcode/day002-%E7%AC%AC%E4%B8%80%E7%AB%A0%E6%95%B0%E7%BB%84/">Day002 ç¬¬ä¸€ç« æ•°ç»„</a>
</li>
<li>
<a class="" href="/notes/leetcode/day003-%E7%AC%AC%E4%BA%8C%E7%AB%A0%E9%93%BE%E8%A1%A8/">Day003 ç¬¬äºŒç« é“¾è¡¨</a>
</li>
<li>
<a class="" href="/notes/leetcode/day004-%E7%AC%AC%E4%BA%8C%E7%AB%A0%E9%93%BE%E8%A1%A8/">Day004 ç¬¬äºŒç« é“¾è¡¨</a>
</li>
<li>
<a class="" href="/notes/leetcode/day006-%E7%AC%AC%E4%B8%89%E7%AB%A0%E5%93%88%E5%B8%8C%E8%A1%A8/">Day006 ç¬¬ä¸‰ç« å“ˆå¸Œè¡¨</a>
</li>
<li>
<a class="" href="/notes/leetcode/day007-%E7%AC%AC%E4%B8%89%E7%AB%A0%E5%93%88%E5%B8%8C%E8%A1%A8/">Day007 ç¬¬ä¸‰ç« å“ˆå¸Œè¡¨</a>
</li>
<li>
<a class="" href="/notes/leetcode/day008-%E7%AC%AC%E5%9B%9B%E7%AB%A0%E5%AD%97%E7%AC%A6%E4%B8%B2/">Day008 ç¬¬å››ç« å­—ç¬¦ä¸²</a>
</li>
<li>
<a class="" href="/notes/leetcode/day009-%E7%AC%AC%E5%9B%9B%E7%AB%A0%E5%AD%97%E7%AC%A6%E4%B8%B2/">Day009 ç¬¬å››ç« å­—ç¬¦ä¸²</a>
</li>
<li>
<a class="" href="/notes/leetcode/day010-%E7%AC%AC%E4%BA%94%E7%AB%A0%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97/">Day010 ç¬¬äº”ç« æ ˆä¸é˜Ÿåˆ—</a>
</li>
<li>
<a class="" href="/notes/leetcode/day011-%E7%AC%AC%E4%BA%94%E7%AB%A0%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97/">Day011 ç¬¬äº”ç« æ ˆä¸é˜Ÿåˆ—</a>
</li>
<li>
<a class="" href="/notes/leetcode/day013-%E7%AC%AC%E4%BA%94%E7%AB%A0%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97/">Day013 ç¬¬äº”ç« æ ˆä¸é˜Ÿåˆ—</a>
</li>
<li>
<a class="" href="/notes/leetcode/day014-%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BA%8C%E5%8F%89%E6%A0%91/">Day014 ç¬¬å…­ç« äºŒå‰æ ‘</a>
</li>
<li>
<a class="" href="/notes/leetcode/day015-%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BA%8C%E5%8F%89%E6%A0%91/">Day015 ç¬¬å…­ç« äºŒå‰æ ‘</a>
</li>
<li>
<a class="" href="/notes/leetcode/day017-%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BA%8C%E5%8F%89%E6%A0%91/">Day017 ç¬¬å…­ç« äºŒå‰æ ‘</a>
</li>
</ul>
</li>
<li>
<input class="toggle" id="section-4f95435d3a74007e2c985ea455bbb6e6" type="checkbox"/>
<label class="flex justify-between" for="section-4f95435d3a74007e2c985ea455bbb6e6">
<a class="" role="button">MyBatisPlus</a>
</label>
<ul>
<li>
<a class="" href="/notes/mybatisplus/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/">MPå¿«é€Ÿå…¥é—¨</a>
</li>
<li>
<a class="" href="/notes/mybatisplus/%E4%B8%80%E8%88%AC%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C/">ä¸€èˆ¬æŸ¥è¯¢æ“ä½œ</a>
</li>
<li>
<a class="" href="/notes/mybatisplus/%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2/">åˆ†é¡µæŸ¥è¯¢</a>
</li>
<li>
<a class="" href="/notes/mybatisplus/%E9%80%BB%E8%BE%91%E5%88%A0%E9%99%A4/">é€»è¾‘åˆ é™¤</a>
</li>
<li>
<a class="" href="/notes/mybatisplus/%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2/">æ¡ä»¶æŸ¥è¯¢</a>
</li>
<li>
<a class="" href="/notes/mybatisplus/%E5%B0%81%E8%A3%85service%E4%BD%BF%E7%94%A8/">å°è£…serviceä½¿ç”¨</a>
</li>
</ul>
</li>
<li>
<input class="toggle" id="section-e2ca0d138d67d9d3ae55da25ac044829" type="checkbox"/>
<label class="flex justify-between" for="section-e2ca0d138d67d9d3ae55da25ac044829">
<a class="" role="button">Redis</a>
</label>
<ul>
<li>
<a class="" href="/notes/redis/nosql%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E4%BB%8B/">No Sqlæ•°æ®åº“ç®€ä»‹</a>
</li>
<li>
<a class="" href="/notes/redis/redis-key/">Redis Key</a>
</li>
<li>
<a class="" href="/notes/redis/redis-string/">Redis String</a>
</li>
<li>
<a class="" href="/notes/redis/redis-list/">Redis List</a>
</li>
<li>
<a class="" href="/notes/redis/redis-set/">Redis Set</a>
</li>
<li>
<a class="" href="/notes/redis/redis-hash/">Redis Hash</a>
</li>
<li>
<a class="" href="/notes/redis/redis-zset/">Redis Zset</a>
</li>
<li>
<a class="" href="/notes/redis/redis-%E5%8F%91%E5%B8%83%E4%B8%8E%E8%AE%A2%E9%98%85/">Redis å‘å¸ƒä¸è®¢é˜…</a>
</li>
<li>
<a class="" href="/notes/redis/redis-jedis/">Redis Jedis</a>
</li>
<li>
<a class="" href="/notes/redis/springboot-%E6%95%B4%E5%90%88-redis/">Spring Boot æ•´åˆ Redis</a>
</li>
<li>
<a class="" href="/notes/redis/redis-%E4%BA%8B%E5%8A%A1%E5%92%8C%E9%94%81%E6%9C%BA%E5%88%B6/">Redis äº‹åŠ¡å’Œé”æœºåˆ¶</a>
</li>
</ul>
</li>
<li>
<input checked="" class="toggle" id="section-39abd0d44427d4a54e694a2b3f22d967" type="checkbox"/>
<label class="flex justify-between" for="section-39abd0d44427d4a54e694a2b3f22d967">
<a class="" role="button">TensorFlow</a>
</label>
<ul>
<li>
<a class="" href="/notes/tensorflow/tensorflow-%E7%AC%94%E8%AE%B0%E4%B8%80/">Tensor Flow ç¬”è®°ï¼ˆä¸€ï¼‰</a>
</li>
<li>
<a class="active" href="/notes/tensorflow/tensorflow-%E7%AC%94%E8%AE%B0%E4%BA%8C/">Tensor Flow ç¬”è®°ï¼ˆäºŒï¼‰</a>
</li>
<li>
<a class="" href="/notes/tensorflow/tensorflow-%E7%AC%94%E8%AE%B0%E4%B8%89/">Tensor Flow ç¬”è®°ï¼ˆä¸‰ï¼‰</a>
</li>
<li>
<a class="" href="/notes/tensorflow/tensorflow-%E7%AC%94%E8%AE%B0%E5%9B%9B/">Tensor Flow ç¬”è®°ï¼ˆå››ï¼‰</a>
</li>
<li>
<a class="" href="/notes/tensorflow/tensorflow-%E7%AC%94%E8%AE%B0%E4%BA%94/">Tensor Flow ç¬”è®°ï¼ˆäº”ï¼‰</a>
</li>
</ul>
</li>
<li>
<input class="toggle" id="section-a42f4efe12b0d964f8de7588b38cb659" type="checkbox"/>
<label class="flex justify-between" for="section-a42f4efe12b0d964f8de7588b38cb659">
<a class="" role="button">Javaå…«è‚¡</a>
</label>
<ul>
<li>
<a class="" href="/notes/%E5%85%AB%E8%82%A1/%E5%B9%B6%E5%8F%91/">Concurrence</a>
</li>
<li>
<a class="" href="/notes/%E5%85%AB%E8%82%A1/mybatis/">MyBatis</a>
</li>
<li>
<a class="" href="/notes/%E5%85%AB%E8%82%A1/mysql/">MySQL</a>
</li>
</ul>
</li>
<li>
<input class="toggle" id="section-3907b2cf55ed520ad784e24525c8baa4" type="checkbox"/>
<label class="flex justify-between" for="section-3907b2cf55ed520ad784e24525c8baa4">
<a class="" role="button">Swift</a>
</label>
<ul>
<li>
<a class="" href="/notes/swift/swiftui-%E5%B8%B8%E7%94%A8%E8%A7%86%E5%9B%BE-views/">Swift Ui å¸¸ç”¨è§†å›¾ Views</a>
</li>
<li>
<a class="" href="/notes/swift/swiftui-%E4%BF%A1%E6%81%AF%E8%A7%86%E5%9B%BE-views/">Swift Ui ä¿¡æ¯è§†å›¾ Views</a>
</li>
<li>
<a class="" href="/notes/swift/swiftui-%E5%B1%82%E7%BA%A7%E8%A7%86%E5%9B%BE-views/">Swift Ui å±‚çº§è§†å›¾ Views</a>
</li>
<li>
<a class="" href="/notes/swift/swiftui-%E6%8E%A7%E5%88%B6%E8%A7%86%E5%9B%BE-views/">Swift Ui æ§åˆ¶è§†å›¾ Views</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="book-section-flat">
<span>--è§£å†³æ–¹æ¡ˆ--ğŸ‘‡</span>
<ul>
<li>
<input class="toggle" id="section-f1d4602254471b9d0da445dd468cd456" type="checkbox"/>
<label class="flex justify-between" for="section-f1d4602254471b9d0da445dd468cd456">
<a class="" role="button">ç¯å¢ƒé…ç½®</a>
</label>
<ul>
<li>
<a class="" href="/solution/environment/apple-m%E7%B3%BB%E5%88%97%E8%8A%AF%E7%89%87%E5%AE%89%E8%A3%85-pyqt/">Apple Mç³»åˆ—èŠ¯ç‰‡å®‰è£… Pyqt</a>
</li>
<li>
<a class="" href="/solution/environment/docker-%E5%AE%89%E8%A3%85-redis-/">Docker å®‰è£… Redis</a>
</li>
<li>
<a class="" href="/solution/environment/hugo-%E4%B8%BB%E9%A2%98-hugo-book-%E4%B8%AD%E8%8B%B1%E6%96%87%E6%90%9C%E7%B4%A2%E9%85%8D%E7%BD%AE/">Hugo ä¸»é¢˜ Hugo Book ä¸­è‹±æ–‡æœç´¢é…ç½®</a>
</li>
<li>
<a class="" href="/solution/environment/iterm2-oh-my-zsh-%E9%85%8D%E7%BD%AE/">I Term2 Oh My Zsh é…ç½®</a>
</li>
<li>
<a class="" href="/solution/environment/m1-%E8%8A%AF%E7%89%87-docker-%E5%AE%89%E8%A3%85-mysql5.7-/">M1 èŠ¯ç‰‡ Docker å®‰è£… Mysql5.7</a>
</li>
<li>
<a class="" href="/solution/environment/mac-idea-%E5%BF%AB%E6%8D%B7%E9%94%AE%E4%BD%8D/">MAC Idea å¿«æ·é”®ä½</a>
</li>
<li>
<a class="" href="/solution/environment/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/">å†…ç½‘ç©¿é€</a>
</li>
<li>
<a class="" href="/solution/environment/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E7%9A%84%E8%87%AA%E5%90%AF%E5%8A%A8%E8%AE%BE%E7%BD%AE/">å†…ç½‘ç©¿é€çš„è‡ªå¯åŠ¨è®¾ç½®</a>
</li>
</ul>
</li>
<li>
<input class="toggle" id="section-5a76a664ba4855b79d3c1bc77e5b08b1" type="checkbox"/>
<label class="flex justify-between" for="section-5a76a664ba4855b79d3c1bc77e5b08b1">
<a class="" role="button">æ‚ä¹±é—®é¢˜</a>
</label>
<ul>
<li>
<a class="" href="/solution/problems/brew-%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">Brew ä¸€äº›å¸¸ç”¨å‘½ä»¤</a>
</li>
<li>
<a class="" href="/solution/problems/docker-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">Docker å¸¸ç”¨å‘½ä»¤</a>
</li>
<li>
<a class="" href="/solution/problems/git-github-%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%E6%95%B4%E7%90%86/">Git Git Hub ç›¸å…³å‘½ä»¤æ•´ç†</a>
</li>
<li>
<a class="" href="/solution/problems/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%89%AB%E7%9B%B2/">é¢è¯•é¢˜æ‰«ç›²</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="book-section-flat">
<span>--å…¶ä»–è®°å½•--ğŸ‘‡</span>
<ul>
<li>
<input class="toggle" id="section-9ef4d2063ddc9af7785b193647f22260" type="checkbox"/>
<label class="flex justify-between" for="section-9ef4d2063ddc9af7785b193647f22260">
<a class="" role="button">æˆ‘å’Œé˜¿åˆ</a>
</label>
<ul>
<li>
<a class="" href="/daily/ad/%E5%85%B3%E4%BA%8E%E9%98%BF%E5%88%812022%E5%B9%B4%E7%9A%84%E7%94%9F%E6%97%A5%E7%9A%84%E5%B0%8F%E8%AE%BA%E6%96%87/">å…³äºé˜¿åˆ2022å¹´çš„ç”Ÿæ—¥çš„å°è®ºæ–‡</a>
</li>
<li>
<a class="" href="/daily/ad/%E5%85%B3%E4%BA%8E%E9%98%BF%E5%88%81%E7%9A%842021%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/">å…³äºé˜¿åˆçš„2021å¹´åº¦æ€»ç»“</a>
</li>
<li>
<a class="" href="/daily/ad/%E5%85%B3%E4%BA%8E%E9%98%BF%E5%88%81%E7%9A%842022%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/">å…³äºé˜¿åˆçš„2022å¹´åº¦æ€»ç»“</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>
</div>
</aside>
<div class="book-page">
<header class="book-header">
<div class="flex align-center justify-between">
<label for="menu-control">
<img alt="Menu" class="book-icon" src="/svg/menu.svg"/>
</label>
<strong>Tensor Flow ç¬”è®°ï¼ˆäºŒï¼‰</strong>
<label for="toc-control">
<img alt="Table of Contents" class="book-icon" src="/svg/toc.svg"/>
</label>
</div>
<aside class="hidden clearfix">
<nav id="TableOfContents">
<ul>
<li><a href="#tensorflow-ç¬”è®°äºŒ">TensorFlow ç¬”è®°ï¼ˆäºŒï¼‰</a>
<ul>
<li><a href="#1-é¢„å¤‡çŸ¥è¯†">1. é¢„å¤‡çŸ¥è¯†</a></li>
<li><a href="#2-ç¥ç»ç½‘ç»œå¤æ‚åº¦">2. ç¥ç»ç½‘ç»œå¤æ‚åº¦</a></li>
<li><a href="#3-æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡">3. æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡</a></li>
<li><a href="#4æ¿€æ´»å‡½æ•°">4.æ¿€æ´»å‡½æ•°</a>
<ul>
<li><a href="#41-sigmoid-å‡½æ•°">4.1 Sigmoid å‡½æ•°</a></li>
<li><a href="#42-reluå‡½æ•°">4.2 Reluå‡½æ•°</a></li>
<li><a href="#42-æ€»ç»“">4.2 æ€»ç»“</a></li>
</ul>
</li>
<li><a href="#5æŸå¤±å‡½æ•°">5.æŸå¤±å‡½æ•°</a>
<ul>
<li><a href="#51-å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°">5.1 å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°</a></li>
<li><a href="#52-è‡ªå®šä¹‰æŸå¤±å‡½æ•°">5.2 è‡ªå®šä¹‰æŸå¤±å‡½æ•°</a></li>
<li><a href="#53-äº¤å‰ç†µæŸå¤±å‡½æ•°cross-entropy">5.3 äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼ˆCross Entropyï¼‰</a></li>
</ul>
</li>
<li><a href="#6-æ¬ æ‹Ÿåˆä¸è¿‡æ‹Ÿåˆ">6. æ¬ æ‹Ÿåˆä¸è¿‡æ‹Ÿåˆ</a>
<ul>
<li><a href="#61-è§£å†³æ–¹æ¡ˆ">6.1 è§£å†³æ–¹æ¡ˆ</a></li>
<li><a href="#62-æ­£åˆ™åŒ–ç¼“è§£è¿‡æ‹Ÿåˆ">6.2 æ­£åˆ™åŒ–ç¼“è§£è¿‡æ‹Ÿåˆ</a></li>
</ul>
</li>
<li><a href="#7-ä¼˜åŒ–å™¨">7. ä¼˜åŒ–å™¨</a>
<ul>
<li><a href="#71-æ›´æ–°å‚æ•°å››æ­¥éª¤">7.1 æ›´æ–°å‚æ•°å››æ­¥éª¤</a></li>
<li><a href="#72-sgdæ— momentumå¸¸ç”¨çš„æ¢¯åº¦ä¸‹é™æ³•">7.2 SGDï¼ˆæ— momentumï¼‰ï¼Œå¸¸ç”¨çš„æ¢¯åº¦ä¸‹é™æ³•</a></li>
<li><a href="#73-sgdmå«momentumçš„sgdåœ¨-sgd-åŸºç¡€ä¸Šå¢åŠ äº†ä¸€é˜¶åŠ¨é‡">7.3 SGDMï¼ˆå«momentumçš„SGDï¼‰ï¼Œåœ¨ SGD åŸºç¡€ä¸Šå¢åŠ äº†ä¸€é˜¶åŠ¨é‡</a></li>
<li><a href="#74-adagrad-åœ¨-sgd-åŸºç¡€ä¸Šå¢åŠ äºŒé˜¶åŠ¨é‡">7.4 Adagrad, åœ¨ SGD åŸºç¡€ä¸Šå¢åŠ äºŒé˜¶åŠ¨é‡</a></li>
<li><a href="#75-rmspropsgdåŸºç¡€ä¸Šå¢åŠ äºŒé˜¶åŠ¨é‡">7.5 RMSPropï¼ŒSGDåŸºç¡€ä¸Šå¢åŠ äºŒé˜¶åŠ¨é‡</a></li>
<li><a href="#76-adamåŒæ—¶ç»“åˆ-sgdm-çš„ä¸€é˜¶åŠ¨é‡å’Œ-rmsprop-äºŒé˜¶åŠ¨é‡">7.6 Adamï¼ŒåŒæ—¶ç»“åˆ SGDM çš„ä¸€é˜¶åŠ¨é‡å’Œ RMSProp äºŒé˜¶åŠ¨é‡</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</aside>
</header>
<article class="markdown"><h1 id="tensorflow-ç¬”è®°äºŒ">
  TensorFlow ç¬”è®°ï¼ˆäºŒï¼‰
  <a class="anchor" href="#tensorflow-%e7%ac%94%e8%ae%b0%e4%ba%8c">#</a>
</h1>
<p>ä»‹ç»ç¥ç»ç½‘ç»œçš„ä¼˜åŒ–è¿‡ç¨‹ï¼Œä¸»è¦æœ‰ï¼š</p>
<ol>
<li>ç¥ç»ç½‘ç»œå¤æ‚åº¦</li>
<li>æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡</li>
<li>æ¿€æ´»å‡½æ•°</li>
<li>æŸå¤±å‡½æ•°</li>
<li>æ¬ æ‹Ÿåˆä¸è¿‡æ‹Ÿåˆ</li>
<li>æ­£åˆ™åŒ–å‡å°‘è¿‡æ‹Ÿåˆ</li>
<li>ä¼˜åŒ–å™¨æ›´æ–°ç½‘ç»œå‚æ•°</li>
</ol>
<h2 id="1-é¢„å¤‡çŸ¥è¯†">
  1. é¢„å¤‡çŸ¥è¯†
  <a class="anchor" href="#1-%e9%a2%84%e5%a4%87%e7%9f%a5%e8%af%86">#</a>
</h2>
<ul>
<li><code>tf.where(æ¡ä»¶è¯­å¥ï¼ŒçœŸè¿”å›Aï¼Œå‡è¿”å›B)</code>ï¼šæ¡ä»¶è¯­å¥ï¼ŒçœŸè¿”å›Aï¼Œå‡è¿”å›B</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-python" data-lang="python"><span style="display:flex;"><span>a <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>constant([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>constant([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>])
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>where(tf<span style="color:#f92672">.</span>greater(a, b), a, b) <span style="color:#75715e"># è‹¥a&gt;bï¼Œè¿”å› a å¯¹åº”ä½ç½®çš„å…ƒç´ ï¼Œå¦åˆ™è¿”å› b å¯¹åº”ä½ç½®çš„å…ƒç´ </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>è¾“å‡º<span style="color:#960050;background-color:#1e0010">ï¼š</span>c <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>Tensor([<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">5</span>], shape<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>,), dtype<span style="color:#f92672">=</span>int32)
</span></span></code></pre></div><ul>
<li><code>np.random.RandomState.rand(ç»´åº¦)</code>ï¼šè¿”å› [0, 1) ä¹‹é—´çš„éšæœºæ•°</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-python" data-lang="python"><span style="display:flex;"><span>rdm <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>RandomState(seed<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> rdm<span style="color:#f92672">.</span>rand() <span style="color:#75715e"># è¿”å›ä¸€ä¸ªéšæœºæ ‡é‡</span>
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> rdm<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>) <span style="color:#75715e"># è¿”å›ç»´åº¦ä¸º2è¡Œ3åˆ—éšæœºæ•°çŸ©é˜µ</span>
</span></span></code></pre></div><ul>
<li><code>np.vstack(æ•°ç»„1ï¼Œ æ•°ç»„2)</code>ï¼šå°†ä¸¤ä¸ªæ•°ç»„æŒ‰å‚ç›´æ–¹å‘å åŠ </li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-python" data-lang="python"><span style="display:flex;"><span>a <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>])
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>])
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>vstack((a, b))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ç»“æœ<span style="color:#960050;background-color:#1e0010">ï¼š</span>
</span></span><span style="display:flex;"><span>[[<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span>]
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">6</span>]]
</span></span></code></pre></div><ul>
<li><code>np.mgrid[]	.ravel()	np.c_[]</code></li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-python" data-lang="python"><span style="display:flex;"><span>np<span style="color:#f92672">.</span>mgrid[èµ·å§‹å€¼:ç»“æŸå€¼:æ­¥é•¿, èµ·å§‹å€¼:ç»“æŸå€¼:æ­¥é•¿, <span style="color:#f92672">...</span>] <span style="color:#75715e"># å‡ ç»„ç”Ÿæˆçš„æ•°æ®å°±å‡ çº¬ï¼Œåˆ—æ•°ç”±ç»„å‚æ•°å†³å®š</span>
</span></span><span style="display:flex;"><span>x<span style="color:#f92672">.</span>ravel() <span style="color:#75715e"># å°† x å˜ä¸ºä¸€ç»´æ•°ç»„ï¼Œ"æŠŠ . å‰çš„å˜é‡æ‹‰ç›´"</span>
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>c_[] ä½¿è¿”å›çš„é—´éš”æ•°å€¼ç‚¹é…å¯¹
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ä¾‹<span style="color:#960050;background-color:#1e0010">ï¼š</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>x, y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>mgrid[<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">3</span>:<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">4</span>:<span style="color:#ae81ff">0.5</span>]
</span></span><span style="display:flex;"><span>grid <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>c_[x<span style="color:#f92672">.</span>ravel(), y<span style="color:#f92672">.</span>ravel()]
</span></span></code></pre></div><h2 id="2-ç¥ç»ç½‘ç»œå¤æ‚åº¦">
  2. ç¥ç»ç½‘ç»œå¤æ‚åº¦
  <a class="anchor" href="#2-%e7%a5%9e%e7%bb%8f%e7%bd%91%e7%bb%9c%e5%a4%8d%e6%9d%82%e5%ba%a6">#</a>
</h2>
<p>ç©ºé—´å¤æ‚åº¦ï¼š</p>
<ul>
<li>å±‚æ•° = éšè—å±‚çš„å±‚æ•° + 1ä¸ªè¾“å‡ºå±‚</li>
<li>æ€»å‚æ•° = æ€»w + æ€»b</li>
</ul>
<p>æ—¶é—´å¤æ‚åº¦ï¼š</p>
<ul>
<li>å³ä¹˜åŠ è¿ç®—æ¬¡æ•°</li>
</ul>
<h2 id="3-æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡">
  3. æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡
  <a class="anchor" href="#3-%e6%8c%87%e6%95%b0%e8%a1%b0%e5%87%8f%e5%ad%a6%e4%b9%a0%e7%8e%87">#</a>
</h2>
<p>å¯ä»¥å…ˆç”¨è¾ƒå¤§çš„å­¦ä¹ ç‡ï¼Œå¿«é€Ÿå¾—åˆ°è¾ƒä¼˜è§£ï¼Œç„¶åé€æ­¥å‡å°å­¦ä¹ ç‡ï¼Œä½¿æ¨¡å‹åœ¨è®­ç»ƒåæœŸç¨³å®šã€‚

<link href="/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/katex/katex.min.js"></script>
<script defer="" onload="renderMathInElement(document.body);" src="/katex/auto-render.min.js"></script><span>
  \[æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡ = åˆå§‹å­¦ä¹ ç‡ . å­¦ä¹ ç‡è¡°å‡^{å½“å‰è½®æ•° / å¤šå°‘è½®è¡°å‡ä¸€æ¬¡}\]
</span>
</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-python" data-lang="python"><span style="display:flex;"><span>epoch <span style="color:#f92672">=</span> <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>LR_BASE <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.2</span>
</span></span><span style="display:flex;"><span>LR_DECAY <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.99</span>
</span></span><span style="display:flex;"><span>LR_STEP <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> epoch <span style="color:#f92672">in</span> range(epoch):
</span></span><span style="display:flex;"><span>  lr <span style="color:#f92672">=</span> LR_BASE <span style="color:#f92672">*</span> LR_DECAY <span style="color:#f92672">**</span> (epoch <span style="color:#f92672">/</span> LR_STEP)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">with</span> tf<span style="color:#f92672">.</span>GradientTape() <span style="color:#66d9ef">as</span> tape:
</span></span><span style="display:flex;"><span>    loss <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>square(w <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>  grads <span style="color:#f92672">=</span> tape<span style="color:#f92672">.</span>gradient(loss, w)
</span></span><span style="display:flex;"><span>  w<span style="color:#f92672">.</span>assign_sub(lr <span style="color:#f92672">*</span> grads)
</span></span></code></pre></div><h2 id="4æ¿€æ´»å‡½æ•°">
  4.æ¿€æ´»å‡½æ•°
  <a class="anchor" href="#4%e6%bf%80%e6%b4%bb%e5%87%bd%e6%95%b0">#</a>
</h2>
<h3 id="41-sigmoid-å‡½æ•°">
  4.1 Sigmoid å‡½æ•°
  <a class="anchor" href="#41-sigmoid-%e5%87%bd%e6%95%b0">#</a>
</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-python" data-lang="python"><span style="display:flex;"><span>tf<span style="color:#f92672">.</span>nn<span style="color:#f92672">.</span>sigmoid(x)
</span></span></code></pre></div><span>
  \[f(x) = \frac{1}{1+{e^{-x}}}\]
</span>
<p>ç‰¹ç‚¹ï¼š</p>
<ol>
<li>å®¹æ˜“é€ æˆæ¢¯åº¦æ¶ˆå¤±(å› ä¸ºæ¢¯åº¦å°)</li>
<li>è¾“å‡ºé0å‡å€¼ï¼Œæ”¶æ•›æ…¢</li>
<li>å¹‚è¿ç®—å¤æ‚ï¼Œè®­ç»ƒæ—¶é—´é•¿</li>
</ol>
<h3 id="42-reluå‡½æ•°">
  4.2 Reluå‡½æ•°
  <a class="anchor" href="#42-relu%e5%87%bd%e6%95%b0">#</a>
</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-python" data-lang="python"><span style="display:flex;"><span>tf<span style="color:#f92672">.</span>nn<span style="color:#f92672">.</span>relu(x)
</span></span></code></pre></div><span>
  \[f(x) = max(x, 0) = \begin{cases}0, &amp; x&lt;0 \\ 1, &amp; x \ge0\end{cases}\]
</span>
<p>ä¼˜ç‚¹ï¼š</p>
<ol>
<li>è§£å†³äº†æ¢¯åº¦æ¶ˆå¤±é—®é¢˜</li>
<li>åªéœ€è¦åˆ¤æ–­è¾“å…¥æ˜¯å¦å¤§äº0ï¼Œè®¡ç®—é€Ÿåº¦å¿«</li>
<li>æ”¶æ•›é€Ÿåº¦è¿œå¿«äº<code>sigmoid</code>å’Œ<code>tanh</code></li>
</ol>
<p>ç¼ºç‚¹ï¼š</p>
<ol>
<li>è¾“å‡ºé 0 å‡å€¼ï¼Œæ”¶æ•›æ…¢</li>
<li>æŸäº›ç¥ç»å…ƒå¯èƒ½æ°¸è¿œæœªè¢«æ¿€æ´»ï¼Œå¯¼è‡´ç›¸åº”çš„å‚æ•°æ°¸è¿œä¸èƒ½è¢«æ›´æ–°</li>
</ol>
<h3 id="42-æ€»ç»“">
  4.2 æ€»ç»“
  <a class="anchor" href="#42-%e6%80%bb%e7%bb%93">#</a>
</h3>
<ul>
<li>
<p>é¦–é€‰ relu æ¿€æ´»å‡½æ•°</p>
</li>
<li>
<p>å­¦ä¹ ç‡è®¾ç½®è¾ƒå°å€¼</p>
</li>
<li>
<p>è¾“å…¥ç‰¹å¾æ ‡å‡†åŒ–ï¼Œå³è®©è¾“å…¥ç‰¹å¾æ»¡è¶³ä»¥ 0 ä¸ºå‡å€¼ï¼Œ1 ä¸ºæ ‡å‡†å·®çš„æ­£æ€åˆ†å¸ƒ</p>
</li>
<li>
<p>åˆå§‹å‚æ•°ä¸­å¿ƒåŒ–ï¼Œå³è®©éšæœºç”Ÿæˆçš„å‚æ•°æ»¡è¶³ä»¥0ä¸ºå‡å€¼ï¼Œ<span>
  \(\sqrt\frac{2}{å½“å‰è¾“å…¥ç‰¹å¾ä¸ªæ•°}\)
</span>
</p>
<p>ä¸ºæ ‡å‡†å·®çš„æ­£æ€åˆ†å¸ƒã€‚</p>
</li>
</ul>
<h2 id="5æŸå¤±å‡½æ•°">
  5.æŸå¤±å‡½æ•°
  <a class="anchor" href="#5%e6%8d%9f%e5%a4%b1%e5%87%bd%e6%95%b0">#</a>
</h2>
<p>æŸå¤±å‡½æ•°ï¼šé¢„æµ‹å€¼ï¼ˆyï¼‰ä¸å·²çŸ¥ç­”æ¡ˆï¼ˆy_ï¼‰çš„å·®è·</p>
<p>æŸå¤±å‡½æ•°çš„ä¼˜åŒ–ç›®æ ‡ï¼šä½¿ loss æœ€å°ï¼Œä¸»è¦æœ‰ä»¥ä¸‹æŸå¤±å‡½æ•°</p>
<ul>
<li>mse (Mean Squared Error)</li>
<li>è‡ªå®šä¹‰</li>
<li>ce(Cross Entropy)</li>
</ul>
<h3 id="51-å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°">
  5.1 å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°
  <a class="anchor" href="#51-%e5%9d%87%e6%96%b9%e8%af%af%e5%b7%ae%e6%8d%9f%e5%a4%b1%e5%87%bd%e6%95%b0">#</a>
</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-python" data-lang="python"><span style="display:flex;"><span>loss_mse <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>reduce_mean(tf<span style="color:#f92672">.</span>square(y_<span style="color:#f92672">-</span>y))
</span></span></code></pre></div><p><span>
  \[MSE(y\_, y) = \frac{\Sigma^n_{i=1}(y-y\_)^2}{n}\]
</span>

ä¾‹ï¼š</p>
<blockquote>
<p>é¢„æµ‹é…¸å¥¶æ—¥é”€é‡ yï¼Œ<span>
  \(x_1\)
</span>
 å’Œ <span>
  \(x_2\)
</span>
æ˜¯å½±å“æ—¥å¸¸é”€é‡çš„å› ç´ ã€‚</p>
</blockquote>
<blockquote>
<p>å»ºæ¨¡å‰ï¼Œåº”é¢„å…ˆé‡‡é›†çš„æ•°æ®æœ‰ï¼šæ¯æ—¥<span>
  \(x_1\)
</span>
 , <span>
  \(x_2\)
</span>
å’Œæ—¥é”€é‡<span>
  \(y\_\)
</span>
ï¼ˆå³å·²çŸ¥ç­”æ¡ˆï¼šæœ€ä½³æƒ…å†µï¼šäº§é‡=é”€é‡ï¼‰ï¼Œæ‹Ÿé€ æ•°æ®é›†<span>
  \(X\)
</span>
, <span>
  \(Y\_\)
</span>
  :  <span>
  \(y\_=x_1 + x_2\)
</span>
   å™ªå£°ï¼š<span>
  \(-0.05~+0.05\)
</span>
 æ‹Ÿåˆå¯ä»¥é¢„æµ‹é”€é‡çš„å‡½æ•°ã€‚</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> tensorflow <span style="color:#66d9ef">as</span> tf
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SEED <span style="color:#f92672">=</span> <span style="color:#ae81ff">23455</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>rdm <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>RandomState(SEED)
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> rdm<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>y_ <span style="color:#f92672">=</span> [[x1 <span style="color:#f92672">+</span> x2 <span style="color:#f92672">+</span> (rdm<span style="color:#f92672">.</span>rand() <span style="color:#f92672">/</span> <span style="color:#ae81ff">10.0</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.05</span>)] <span style="color:#66d9ef">for</span> (x1, x2) <span style="color:#f92672">in</span> x]
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>cast(x, dtype<span style="color:#f92672">=</span>tf<span style="color:#f92672">.</span>float32)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>w1 <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>Variable(tf<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal([<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>], stddev<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, seed<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>epoch <span style="color:#f92672">=</span> <span style="color:#ae81ff">15000</span>
</span></span><span style="display:flex;"><span>lr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.002</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> epoch <span style="color:#f92672">in</span> range(epoch):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> tf<span style="color:#f92672">.</span>GradientTape() <span style="color:#66d9ef">as</span> tape:
</span></span><span style="display:flex;"><span>        y <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>matmul(x, w1)
</span></span><span style="display:flex;"><span>        loss_mse <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>reduce_mean(tf<span style="color:#f92672">.</span>square(y_ <span style="color:#f92672">-</span> y))
</span></span><span style="display:flex;"><span>    grads <span style="color:#f92672">=</span> tape<span style="color:#f92672">.</span>gradient(loss_mse, w1)
</span></span><span style="display:flex;"><span>    w1<span style="color:#f92672">.</span>assign_sub(lr <span style="color:#f92672">*</span> grads)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> epoch <span style="color:#f92672">%</span> <span style="color:#ae81ff">500</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">"After </span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> training steps, w1 is "</span> <span style="color:#f92672">%</span> (epoch))
</span></span><span style="display:flex;"><span>        print(w1<span style="color:#f92672">.</span>numpy(), <span style="color:#e6db74">"</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">"</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">"Final w1 is: "</span>, w1<span style="color:#f92672">.</span>numpy())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Output:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>  Final w1 <span style="color:#f92672">is</span>:  [[<span style="color:#ae81ff">1.0009792</span>]
</span></span><span style="display:flex;"><span> 	[<span style="color:#ae81ff">0.9977485</span>]]
</span></span></code></pre></div><h3 id="52-è‡ªå®šä¹‰æŸå¤±å‡½æ•°">
  5.2 è‡ªå®šä¹‰æŸå¤±å‡½æ•°
  <a class="anchor" href="#52-%e8%87%aa%e5%ae%9a%e4%b9%89%e6%8d%9f%e5%a4%b1%e5%87%bd%e6%95%b0">#</a>
</h3>
<p>å¦‚ 5.1 é¢„æµ‹å•†å“é”€é‡ï¼Œé¢„æµ‹å¤šäº†ï¼ŒæŸå¤±æˆæœ¬ï¼›é¢„æµ‹å°‘äº†ï¼ŒæŸå¤±åˆ©æ¶¦ã€‚è‹¥<span>
  \(åˆ©æ¶¦\neqæˆæœ¬\)
</span>
åˆ™ mse äº§ç”Ÿçš„ loss æ— æ³•å®ç°åˆ©ç›Šæœ€å¤§åŒ–ã€‚
<span>
  \[è‡ªå®šä¹‰æŸå¤±å‡½æ•°ï¼šloss(y\_,y)=\Sigma{f({y\_}, y)}\]
</span>

ä¼˜åŒ– 5.1 æŸå¤±å‡½æ•°</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-python" data-lang="python"><span style="display:flex;"><span>loss_zdy <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>reduce_sum(tf<span style="color:#f92672">.</span>where(tf<span style="color:#f92672">.</span>greater(y, y_), COST(y<span style="color:#f92672">-</span>y_), PROFIT(y_<span style="color:#f92672">-</span>y)))
</span></span></code></pre></div><p><span>
  \[f(y\_,y)=\begin{cases}PROFIT*(y\_-y), &amp; y&lt;y\_ &amp; é¢„æµ‹çš„yå°‘äº†ï¼ŒæŸå¤±åˆ©æ¶¦\\ COST*(y-y\_), &amp; y \ge y\_ &amp; é¢„æµ‹çš„yå¤šäº†ï¼ŒæŸå¤±æˆæœ¬ \end{cases}\]
</span>

ä¾‹ï¼š</p>
<blockquote>
<p>é¢„æµ‹é…¸å¥¶é”€é‡ï¼Œé…¸å¥¶æˆæœ¬ï¼ˆCOSTï¼‰1å…ƒï¼Œé…¸å¥¶åˆ©æ¶¦ï¼ˆPROFITï¼‰99å…ƒã€‚é¢„æµ‹å°‘äº†æŸå¤±åˆ©æ¶¦99å…ƒï¼Œé¢„æµ‹å¤šäº†æŸå¤±æˆæœ¬1å…ƒã€‚é¢„æµ‹å°‘äº†æŸå¤±å¤§ï¼Œå¸Œæœ›ç”Ÿæˆçš„é¢„æµ‹å‡½æ•°å¾€å¤šäº†é¢„æµ‹ã€‚</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> tensorflow <span style="color:#66d9ef">as</span> tf
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SEED <span style="color:#f92672">=</span> <span style="color:#ae81ff">23455</span>
</span></span><span style="display:flex;"><span>COST <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>PROFIT <span style="color:#f92672">=</span> <span style="color:#ae81ff">99</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>rdm <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>RandomState(SEED)
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> rdm<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>y_ <span style="color:#f92672">=</span> [[x1 <span style="color:#f92672">+</span> x2 <span style="color:#f92672">+</span> (rdm<span style="color:#f92672">.</span>rand() <span style="color:#f92672">/</span> <span style="color:#ae81ff">10.0</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.05</span>)] <span style="color:#66d9ef">for</span> (x1, x2) <span style="color:#f92672">in</span> x]
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>cast(x, dtype<span style="color:#f92672">=</span>tf<span style="color:#f92672">.</span>float32)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>w1 <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>Variable(tf<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal([<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>], stddev<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, seed<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>epoch <span style="color:#f92672">=</span> <span style="color:#ae81ff">15000</span>
</span></span><span style="display:flex;"><span>lr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.002</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> epoch <span style="color:#f92672">in</span> range(epoch):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> tf<span style="color:#f92672">.</span>GradientTape() <span style="color:#66d9ef">as</span> tape:
</span></span><span style="display:flex;"><span>        y <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>matmul(x, w1)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># loss_mse = tf.reduce_mean(tf.square(y_ - y))</span>
</span></span><span style="display:flex;"><span>        loss <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>reduce_sum(tf<span style="color:#f92672">.</span>where(tf<span style="color:#f92672">.</span>greater(y, y_), (y<span style="color:#f92672">-</span>y_) <span style="color:#f92672">*</span> COST, (y_<span style="color:#f92672">-</span>y) <span style="color:#f92672">*</span> PROFIT))
</span></span><span style="display:flex;"><span>    grads <span style="color:#f92672">=</span> tape<span style="color:#f92672">.</span>gradient(loss, w1)
</span></span><span style="display:flex;"><span>    w1<span style="color:#f92672">.</span>assign_sub(lr <span style="color:#f92672">*</span> grads)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> epoch <span style="color:#f92672">%</span> <span style="color:#ae81ff">500</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">"After </span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> training steps, w1 is "</span> <span style="color:#f92672">%</span> (epoch))
</span></span><span style="display:flex;"><span>        print(w1<span style="color:#f92672">.</span>numpy(), <span style="color:#e6db74">"</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">"</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">"Final w1 is: "</span>, w1<span style="color:#f92672">.</span>numpy())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Output:
</span></span><span style="display:flex;"><span>  Final w1 <span style="color:#f92672">is</span>:  [[<span style="color:#ae81ff">1.1420637</span>]
</span></span><span style="display:flex;"><span> 	[<span style="color:#ae81ff">1.101678</span> ]]
</span></span></code></pre></div><h3 id="53-äº¤å‰ç†µæŸå¤±å‡½æ•°cross-entropy">
  5.3 äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼ˆCross Entropyï¼‰
  <a class="anchor" href="#53-%e4%ba%a4%e5%8f%89%e7%86%b5%e6%8d%9f%e5%a4%b1%e5%87%bd%e6%95%b0cross-entropy">#</a>
</h3>
<p>äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼šè¡¨å¾ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„è·ç¦»</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-python" data-lang="python"><span style="display:flex;"><span>tf<span style="color:#f92672">.</span>losses<span style="color:#f92672">.</span>categorical_crossentropy(y_, y)
</span></span></code></pre></div><p><span>
  \[H(y\_,y)=-\Sigma y\_*\ln y\]
</span>
<strong>softmax ä¸äº¤å‰ç†µç»“åˆ</strong>ï¼šè¾“å‡ºå…ˆè¿‡ softmax å‡½æ•°ï¼Œå†è®¡ç®— y ä¸ y_ çš„äº¤å‰ç†µæŸå¤±å‡½æ•°ã€‚</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-python" data-lang="python"><span style="display:flex;"><span>tf<span style="color:#f92672">.</span>nn<span style="color:#f92672">.</span>softmax_cross_entropy_with_logits(y_, y)
</span></span><span style="display:flex;"><span>y_ <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>]])
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([[<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>], [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">5</span>], [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">6.5</span>, <span style="color:#ae81ff">1.2</span>], [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">1</span>]])
</span></span><span style="display:flex;"><span>y_pro <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>nn<span style="color:#f92672">.</span>softmax(y)
</span></span><span style="display:flex;"><span>loss_ce1 <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>losses<span style="color:#f92672">.</span>categorical_crossentropy(y_, y_pro)
</span></span><span style="display:flex;"><span>loss_ce2 <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>nn<span style="color:#f92672">.</span>softmax_cross_entropy_with_logits(y_, y)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>tf<span style="color:#f92672">.</span>nn<span style="color:#f92672">.</span>softmax_cross_entropy_with_logits(y_, y) å‡½æ•°å†…éƒ¨å°±æœ‰ softmaxç®—æ³•<span style="color:#960050;background-color:#1e0010">ï¼Œ</span>ä¸ç”¨å† softmax äº†
</span></span></code></pre></div><h2 id="6-æ¬ æ‹Ÿåˆä¸è¿‡æ‹Ÿåˆ">
  6. æ¬ æ‹Ÿåˆä¸è¿‡æ‹Ÿåˆ
  <a class="anchor" href="#6-%e6%ac%a0%e6%8b%9f%e5%90%88%e4%b8%8e%e8%bf%87%e6%8b%9f%e5%90%88">#</a>
</h2>
<h3 id="61-è§£å†³æ–¹æ¡ˆ">
  6.1 è§£å†³æ–¹æ¡ˆ
  <a class="anchor" href="#61-%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88">#</a>
</h3>
<p>æ¬ æ‹Ÿåˆè§£å†³æ–¹æ³•ï¼š</p>
<ul>
<li>å¢åŠ è¾“å…¥ç‰¹å¾é¡¹</li>
<li>å¢åŠ ç½‘ç»œå‚æ•°</li>
<li>å‡å°‘æ­£åˆ™åŒ–å‚æ•°</li>
</ul>
<p>è¿‡æ‹Ÿåˆè§£å†³æ–¹æ³•ï¼š</p>
<ul>
<li>æ•°æ®æ¸…æ´—</li>
<li>å¢å¤§è®­ç»ƒé›†</li>
<li>é‡‡ç”¨æ­£åˆ™åŒ–</li>
<li>å¢å¤§æ­£åˆ™åŒ–å‚æ•°</li>
</ul>
<h3 id="62-æ­£åˆ™åŒ–ç¼“è§£è¿‡æ‹Ÿåˆ">
  6.2 æ­£åˆ™åŒ–ç¼“è§£è¿‡æ‹Ÿåˆ
  <a class="anchor" href="#62-%e6%ad%a3%e5%88%99%e5%8c%96%e7%bc%93%e8%a7%a3%e8%bf%87%e6%8b%9f%e5%90%88">#</a>
</h3>
<p>æ­£åˆ™åŒ–åœ¨æŸå¤±å‡½æ•°ä¸­å¼•å…¥æ¨¡å‹å¤æ‚åº¦æŒ‡æ ‡ï¼Œåˆ©ç”¨ç»™ W åŠ æƒå€¼ï¼Œå¼±åŒ–äº†è®­ç»ƒæ•°æ®çš„å™ªå£°ï¼ˆä¸€èˆ¬ä¸æ­£åˆ™åŒ–bï¼‰
<span>
  \[loss = loss(y, y\_) + REGULARIZER * loss(w)\]
</span>

L1 æ­£åˆ™åŒ–ï¼š
<span>
  \[loss_{L1}(w) = \Sigma{|w_i|}\]
</span>

L2 æ­£åˆ™åŒ–ï¼š
<span>
  \[loss_{L2}(w)=\Sigma{|w_{i}^2|}\]
</span>

æ­£åˆ™åŒ–çš„é€‰æ‹©ï¼š</p>
<ul>
<li>L1 æ­£åˆ™åŒ–å¤§æ¦‚ç‡ä¼šä½¿å¾ˆå¤šå‚æ•°å˜ä¸º 0ï¼Œå› æ­¤è¯¥æ–¹æ³•å¯é€šè¿‡ç¨€ç–å‚æ•°ï¼Œå³å‡å°‘å‚æ•°çš„æ•°é‡ï¼Œé™ä½å¤æ‚åº¦ã€‚</li>
<li>L2 æ­£åˆ™åŒ–ä¼šä½¿å‚æ•°å¾ˆæ¥è¿‘ 0 ä½†ä¸ä¸º 0ï¼Œå› ä¸ºè¯¥æ–¹æ³•å¯é€šè¿‡å‡å°‘å‚æ•°å€¼çš„å¤§å°é™ä½å¤æ‚åº¦ã€‚</li>
</ul>
<h2 id="7-ä¼˜åŒ–å™¨">
  7. ä¼˜åŒ–å™¨
  <a class="anchor" href="#7-%e4%bc%98%e5%8c%96%e5%99%a8">#</a>
</h2>
<h3 id="71-æ›´æ–°å‚æ•°å››æ­¥éª¤">
  7.1 æ›´æ–°å‚æ•°å››æ­¥éª¤
  <a class="anchor" href="#71-%e6%9b%b4%e6%96%b0%e5%8f%82%e6%95%b0%e5%9b%9b%e6%ad%a5%e9%aa%a4">#</a>
</h3>
<ol>
<li>è®¡ç®— <span>
  \(t\)
</span>
 æ—¶åˆ»æŸå¤±å‡½æ•°å…³äºå½“å‰å‚æ•°çš„æ¢¯åº¦  	<span>
  \(g_t=\nabla{loss}=\frac{\partial loss}{\partial (w_t)} \)
</span>
</li>
<li>è®¡ç®—  <span>
  \(t\)
</span>
 æ—¶åˆ»ä¸€é˜¶åŠ¨é‡ <span>
  \(m_t\)
</span>
 å’ŒäºŒé˜¶åŠ¨é‡ <span>
  \(V_t\)
</span>
</li>
<li>è®¡ç®— <span>
  \(t\)
</span>
 æ—¶åˆ»ä¸‹é™æ¢¯åº¦ï¼š<span>
  \(\eta{_t}=lr. \frac{m_t}{\sqrt{V_t}}\)
</span>
</li>
<li>è®¡ç®— t+1 æ—¶åˆ»å‚æ•°ï¼š <span>
  \(w_{t+1}=w_t - \eta{_t} = w_t - lr. \frac{m_t}{\sqrt V_t}\)
</span>
</li>
</ol>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li>ä¸€é˜¶åŠ¨é‡ï¼šä¸æ¢¯åº¦ç›¸å…³çš„å‡½æ•°</li>
<li>äºŒé˜¶åŠ¨é‡ï¼šä¸æ¢¯åº¦å¹³æ–¹ç›¸å…³çš„å‡½æ•°</li>
</ul>
<h3 id="72-sgdæ— momentumå¸¸ç”¨çš„æ¢¯åº¦ä¸‹é™æ³•">
  7.2 SGDï¼ˆæ— momentumï¼‰ï¼Œå¸¸ç”¨çš„æ¢¯åº¦ä¸‹é™æ³•
  <a class="anchor" href="#72-sgd%e6%97%a0momentum%e5%b8%b8%e7%94%a8%e7%9a%84%e6%a2%af%e5%ba%a6%e4%b8%8b%e9%99%8d%e6%b3%95">#</a>
</h3>
<span>
  \[m_t = g_t \hspace{3cm} V_t = 1\]
</span>
<span>
  \[\eta_t = lr. \frac {m_t}{\sqrt V_t} = lr.g_t\]
</span>
<span>
  \[w_{t+1} = w_t - \eta_t = w_t-lr. \frac {m_t}{\sqrt{V_t}}=w_t-lr.g_t\]
</span>
<span>
  \[w_{t+1}=w_t-lr.\frac{\partial loss}{\partial (w_t)}\]
</span>
<h3 id="73-sgdmå«momentumçš„sgdåœ¨-sgd-åŸºç¡€ä¸Šå¢åŠ äº†ä¸€é˜¶åŠ¨é‡">
  7.3 SGDMï¼ˆå«momentumçš„SGDï¼‰ï¼Œåœ¨ SGD åŸºç¡€ä¸Šå¢åŠ äº†ä¸€é˜¶åŠ¨é‡
  <a class="anchor" href="#73-sgdm%e5%90%abmomentum%e7%9a%84sgd%e5%9c%a8-sgd-%e5%9f%ba%e7%a1%80%e4%b8%8a%e5%a2%9e%e5%8a%a0%e4%ba%86%e4%b8%80%e9%98%b6%e5%8a%a8%e9%87%8f">#</a>
</h3>
<span>
  \[m_t = \beta.m_{t-1} + (1-\beta).g_t \hspace{3cm} V_t = 1\]
</span>
<span>
  \[\eta_t=lr.\frac{m_t}{\sqrt{V_t}}=lr.m_t=lr.(\beta.m_{t-1} + (1-\beta).g_t)\]
</span>
<span>
  \[w_{t+1} = w_t - \eta_t=w_t-lr.(\beta.m_{t-1} + (1-\beta).g_t)\]
</span>
<h3 id="74-adagrad-åœ¨-sgd-åŸºç¡€ä¸Šå¢åŠ äºŒé˜¶åŠ¨é‡">
  7.4 Adagrad, åœ¨ SGD åŸºç¡€ä¸Šå¢åŠ äºŒé˜¶åŠ¨é‡
  <a class="anchor" href="#74-adagrad-%e5%9c%a8-sgd-%e5%9f%ba%e7%a1%80%e4%b8%8a%e5%a2%9e%e5%8a%a0%e4%ba%8c%e9%98%b6%e5%8a%a8%e9%87%8f">#</a>
</h3>
<span>
  \[m_t = g_t \hspace{3cm} V_t = \Sigma^t_\tau g^2_\tau\]
</span>
<span>
  \[\eta_t = lr.\frac{m_t}{\sqrt V_t} = lr.\frac{g_t}{\sqrt{\Sigma^t_\tau g^2_\tau}}\]
</span>
<span>
  \[w_{t+1} = w_t - \eta_t=w_t-lr.\frac{g_t}{\Sigma^t_\tau g^2_\tau}\]
</span>
<h3 id="75-rmspropsgdåŸºç¡€ä¸Šå¢åŠ äºŒé˜¶åŠ¨é‡">
  7.5 RMSPropï¼ŒSGDåŸºç¡€ä¸Šå¢åŠ äºŒé˜¶åŠ¨é‡
  <a class="anchor" href="#75-rmspropsgd%e5%9f%ba%e7%a1%80%e4%b8%8a%e5%a2%9e%e5%8a%a0%e4%ba%8c%e9%98%b6%e5%8a%a8%e9%87%8f">#</a>
</h3>
<span>
  \[m_t = g_t \hspace{3cm} V_t = \beta.V_{t-1} + (1-\beta).g_t^2\]
</span>
<span>
  \[\eta_t = lr.\frac{m_t}{\sqrt V_t} = lr.\frac{g_t}{\sqrt{\beta.V_{t-1} + (1-\beta).g_t^2}}\]
</span>
<span>
  \[w_{t+1} = w_t - \eta_t=w_t-lr.\frac{g_t}{\sqrt{\beta.V_{t-1} + (1-\beta).g_t^2}}\]
</span>
<h3 id="76-adamåŒæ—¶ç»“åˆ-sgdm-çš„ä¸€é˜¶åŠ¨é‡å’Œ-rmsprop-äºŒé˜¶åŠ¨é‡">
  7.6 Adamï¼ŒåŒæ—¶ç»“åˆ SGDM çš„ä¸€é˜¶åŠ¨é‡å’Œ RMSProp äºŒé˜¶åŠ¨é‡
  <a class="anchor" href="#76-adam%e5%90%8c%e6%97%b6%e7%bb%93%e5%90%88-sgdm-%e7%9a%84%e4%b8%80%e9%98%b6%e5%8a%a8%e9%87%8f%e5%92%8c-rmsprop-%e4%ba%8c%e9%98%b6%e5%8a%a8%e9%87%8f">#</a>
</h3>
<span>
  \[m_t = \beta.m_{t-1} + (1-\beta).g_t \hspace{1cm} ä¿®æ­£ä¸€é˜¶åŠ¨é‡çš„åå·®ï¼š\widehat{m_t}=\frac{m_t}{1-\beta_1^t}\]
</span>
<span>
  \[V_t = \beta.V_{t-1} + (1-\beta).g_t^2 \hspace{1cm} ä¿®æ­£ä¸€é˜¶åŠ¨é‡çš„åå·®ï¼š\widehat{V_t}=\frac{V_t}{1-\beta_2^t}\]
</span>
<span>
  \[\eta_t = lr.\frac{\widehat{m_t}}{\sqrt{\widehat{V_t}}}=lr.\frac{\frac{m_t}{1-\beta_1^t}}{\frac{V_t}{1-\beta_2^t}}\]
</span>
<span>
  \[w_{t+1} = w_t - \eta_t = w_t - lr.\frac{\frac{m_t}{1-\beta_1^t}}{\frac{V_t}{1-\beta_2^t}}\]
</span>
</article>
<footer class="book-footer">
<div class="flex flex-wrap justify-between">
</div>
<script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>
</footer>
<div class="book-comments">
</div>
<label class="hidden book-menu-overlay" for="menu-control"></label>
</div>
<aside class="book-toc">
<div class="book-toc-content">
<nav id="TableOfContents">
<ul>
<li><a href="#tensorflow-ç¬”è®°äºŒ">TensorFlow ç¬”è®°ï¼ˆäºŒï¼‰</a>
<ul>
<li><a href="#1-é¢„å¤‡çŸ¥è¯†">1. é¢„å¤‡çŸ¥è¯†</a></li>
<li><a href="#2-ç¥ç»ç½‘ç»œå¤æ‚åº¦">2. ç¥ç»ç½‘ç»œå¤æ‚åº¦</a></li>
<li><a href="#3-æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡">3. æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡</a></li>
<li><a href="#4æ¿€æ´»å‡½æ•°">4.æ¿€æ´»å‡½æ•°</a>
<ul>
<li><a href="#41-sigmoid-å‡½æ•°">4.1 Sigmoid å‡½æ•°</a></li>
<li><a href="#42-reluå‡½æ•°">4.2 Reluå‡½æ•°</a></li>
<li><a href="#42-æ€»ç»“">4.2 æ€»ç»“</a></li>
</ul>
</li>
<li><a href="#5æŸå¤±å‡½æ•°">5.æŸå¤±å‡½æ•°</a>
<ul>
<li><a href="#51-å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°">5.1 å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°</a></li>
<li><a href="#52-è‡ªå®šä¹‰æŸå¤±å‡½æ•°">5.2 è‡ªå®šä¹‰æŸå¤±å‡½æ•°</a></li>
<li><a href="#53-äº¤å‰ç†µæŸå¤±å‡½æ•°cross-entropy">5.3 äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼ˆCross Entropyï¼‰</a></li>
</ul>
</li>
<li><a href="#6-æ¬ æ‹Ÿåˆä¸è¿‡æ‹Ÿåˆ">6. æ¬ æ‹Ÿåˆä¸è¿‡æ‹Ÿåˆ</a>
<ul>
<li><a href="#61-è§£å†³æ–¹æ¡ˆ">6.1 è§£å†³æ–¹æ¡ˆ</a></li>
<li><a href="#62-æ­£åˆ™åŒ–ç¼“è§£è¿‡æ‹Ÿåˆ">6.2 æ­£åˆ™åŒ–ç¼“è§£è¿‡æ‹Ÿåˆ</a></li>
</ul>
</li>
<li><a href="#7-ä¼˜åŒ–å™¨">7. ä¼˜åŒ–å™¨</a>
<ul>
<li><a href="#71-æ›´æ–°å‚æ•°å››æ­¥éª¤">7.1 æ›´æ–°å‚æ•°å››æ­¥éª¤</a></li>
<li><a href="#72-sgdæ— momentumå¸¸ç”¨çš„æ¢¯åº¦ä¸‹é™æ³•">7.2 SGDï¼ˆæ— momentumï¼‰ï¼Œå¸¸ç”¨çš„æ¢¯åº¦ä¸‹é™æ³•</a></li>
<li><a href="#73-sgdmå«momentumçš„sgdåœ¨-sgd-åŸºç¡€ä¸Šå¢åŠ äº†ä¸€é˜¶åŠ¨é‡">7.3 SGDMï¼ˆå«momentumçš„SGDï¼‰ï¼Œåœ¨ SGD åŸºç¡€ä¸Šå¢åŠ äº†ä¸€é˜¶åŠ¨é‡</a></li>
<li><a href="#74-adagrad-åœ¨-sgd-åŸºç¡€ä¸Šå¢åŠ äºŒé˜¶åŠ¨é‡">7.4 Adagrad, åœ¨ SGD åŸºç¡€ä¸Šå¢åŠ äºŒé˜¶åŠ¨é‡</a></li>
<li><a href="#75-rmspropsgdåŸºç¡€ä¸Šå¢åŠ äºŒé˜¶åŠ¨é‡">7.5 RMSPropï¼ŒSGDåŸºç¡€ä¸Šå¢åŠ äºŒé˜¶åŠ¨é‡</a></li>
<li><a href="#76-adamåŒæ—¶ç»“åˆ-sgdm-çš„ä¸€é˜¶åŠ¨é‡å’Œ-rmsprop-äºŒé˜¶åŠ¨é‡">7.6 Adamï¼ŒåŒæ—¶ç»“åˆ SGDM çš„ä¸€é˜¶åŠ¨é‡å’Œ RMSProp äºŒé˜¶åŠ¨é‡</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</aside>
</main>
</body>
</html>
